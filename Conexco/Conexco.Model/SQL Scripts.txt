CAMPOS A AGREGAR

Articulos_Color:
R int
G int
B int

Facturas:
Observaciones varchar(250) nuleable
SonPesos varchar(250) nuleable

Documentos_Estados: VALUES
Pendiente, Pagado, Anulado



------------------------------------------------------------------------

COSAS A HACER:

-Revisar la longitud de los campos de la impresion (ejemplo: SON PESOS)
-Mejorar UI!
-Backups de la base desde el sistema
-Crear instalador


-Tooltips																							HECHO
-Menu opciones para acceder a la informacion de la empresa, cambiar contrasenia y porcentaje IVA.	HECHO
-Agregar seguridad, Contraseña al ingresar al sistema, poder cambiarla desde las opciones			HECHO
-Chekar tema de stock en remitos																	HECHO
-Ver de dejar el campo Envases por defecto en 1														HECHO


------------------------------------------------------------------------

NO OLVIDAR:

Presupueso:
-En formulario Presupuesto agregar leyenda "Los importes expresados no incluyen I.V.A."
-Campo Disponibilidad
-Entrega en
-Cond de Pago
-Exportable e imprimible


Clientes:
En los campos Pagos y Contactos, dejar bastante espacio dado que en pagos van los dias de pago, horario, y telefonos de reclamos y sus respectivos dias.
En Contactos puede haber varios y con sus respectivos mails.

Ver Facturas:
Ordenadas por fecha de vencimiento y estado pendiente, con posibilidad de cambiar el estado.
Poder buscar por cliente
Imprimible? segun lo dificil q sea
Campos de la grilla:
NRO.DE FAC
FECHA DE EMISION
FECHA DE VTO.
CLIENTE
IMPORTE TOTAL DE LA FAC
ESPACIO PARA OBSERVACIONES


------------------------------------------------------------
--Function Para Reportes

ALTER FUNCTION IsNotZero (
@Number varchar(10),
@IsNotZeroNumber varchar(10)
)
RETURNS varchar(10)
AS
BEGIN
 

IF (@Number <> '0')
BEGIN
SET @Number = @IsNotZeroNumber
END
ELSE
BEGIN
SET @Number = ''
END

 

RETURN (@Number)
 

END

GO


--Stored procedures Impresion

CREATE PROCEDURE [dbo].[RemitoLineaImpresion]
(
	@IdRemito int
)
AS
BEGIN

	SELECT rl.idRemitosLinea, rl.idRemito, rl.idArticulo, rl.Envases, 
		rl.Cantidad, rl.Precio, (a.Codigo + dbo.IsNotZero(a.CodColor, '-' + a.CodColor)) 'CodigoYColor', 
		a.Descripcion, (rl.Cantidad * rl.Precio) 'TotalLinea' FROM Remitos_Linea rl
	JOIN Articulos a ON a.idArticulo = rl.idArticulo
	WHERE rl.idRemito = @IdRemito

END


CREATE PROCEDURE [dbo].[RemitoImpresion]
(
	@IdRemito int
)
AS
BEGIN

	SELECT r.*, c.RazonSocial, c.CUIT, ct.Nombre 'NombreTransp', ct.CUIT 'CUITTransp', ct.Domicilio 'DomicilioTransp', ct.Localidad 'LocalidadTransp', ct.CodPostal 'CodPostalTransp',
			ci.Descripcion 'ClienteIVA' FROM Remitos r
	JOIN Clientes c ON r.idCliente = c.idCliente
	JOIN Clientes_Transportistas ct ON r.idTransportista = ct.idTransportista
	JOIN CondicionIVA ci ON c.idCondicionIVA = ci.idCondicionIVA
	

	WHERE r.idRemito = @IdRemito

END

CREATE PROCEDURE [dbo].[FacturaBLineaImpresion]
(
	@IdFactura int
)
AS
BEGIN

	SELECT fl.idFacturasLinea, fl.idFactura, fl.idArticulo, fl.Cantidad, (fl.Precio + (fl.Precio * e.PorcentajeIVA / 100)) 'Precio', (a.Codigo + dbo.IsNotZero(a.CodColor, '-' + a.CodColor)) 'CodigoYColor', a.Descripcion, (fl.Precio * fl.Cantidad + ((fl.Precio * fl.Cantidad) * e.PorcentajeIVA / 100)) 'TotalLinea' FROM Facturas_Linea fl
	JOIN Articulos a ON a.idArticulo = fl.idArticulo
	JOIN Empresa e ON e.idEmpresa = (SELECT TOP 1 idEmpresa FROM Empresa)
	WHERE fl.idFactura = @IdFactura

END



CREATE PROCEDURE FacturaImpresion
(
	@IdFactura int
)
AS
BEGIN

	SELECT f.*, c.RazonSocial, c.CUIT, c.Codigo, cd.Domicilio, 
			cd.Localidad, cd.Provincia, cd.CodPostal, 
			ci.Descripcion FROM Facturas f
	JOIN Clientes c ON f.idCliente = c.idCliente
	JOIN Clientes_Domicilios cd ON c.idCliente = cd.idCliente
	JOIN CondicionIVA ci ON c.idCondicionIVA = ci.idCondicionIVA
	

	WHERE f.idFactura = @IdFactura

END

GO

CREATE PROCEDURE [dbo].[FacturaLineaImpresion]
(
	@IdFactura int
)
AS
BEGIN

	SELECT fl.*, (a.Codigo + dbo.IsNotZero(a.CodColor, '-' + a.CodColor)) 'CodigoYColor', a.Descripcion, (fl.Precio * fl.Cantidad) 'TotalLinea' FROM Facturas_Linea fl
	JOIN Articulos a ON a.idArticulo = fl.idArticulo
	WHERE fl.idFactura = @IdFactura

END



-------------------------------------------------------
	
--Script LIMPIADOR
delete from facturas_linea
delete from remitos_linea
delete from presupuestos_linea
delete from articulos
delete from articulos_color
delete from clientes_contactos
delete from clientes_domicilios
delete from clientes_telefonos
delete from clientes_transportistas
delete from egreso_stock
delete from localidades
delete from facturas
delete from remitos
delete from presupuestos
delete from articulos
delete from clientes
delete from empresa


----------------------------------------------------------

--SCRIPT INSERT EGRESO_MOTIVOS
INSERT INTO Egreso_Motivos (Descripcion)
VALUES ('Devolución por Defecto')

INSERT INTO Egreso_Motivos (Descripcion)
VALUES ('Entrega de muestra')

INSERT INTO Egreso_Motivos (Descripcion)
VALUES ('Rotura sin devolución')

INSERT INTO Egreso_Motivos (Descripcion)
VALUES ('Otro')


--SCRIPT INSERT TIPO DOCUMENTOS
INSERT INTO Documentos_Tipo(Codigo, Descripcion)
VALUES ('A', 'Venta con discriminación de IVA')

INSERT INTO Documentos_Tipo(Codigo, Descripcion)
VALUES ('B', 'Venta sin discriminación de IVA')


--SCRIPT INSERT DOCUMENTOS ESTADOS

INSERT INTO Documentos_Estados (Descripcion)
VALUES ('A Pagar')

INSERT INTO Documentos_Estados (Descripcion)
VALUES ('Pagado')

INSERT INTO Documentos_Estados (Descripcion)
VALUES ('Demorado')

INSERT INTO Documentos_Estados (Descripcion)
VALUES ('Otro')



--SCRIPT INSERT CONDICION IVA

INSERT INTO CondicionIVA (Descripcion)
VALUES ('Responsable Inscripto')

INSERT INTO CondicionIVA (Descripcion)
VALUES ('Consumidor Final')

INSERT INTO CondicionIVA (Descripcion)
VALUES ('Excento')

INSERT INTO CondicionIVA (Descripcion)
VALUES ('No gravado')

INSERT INTO CondicionIVA (Descripcion)
VALUES ('Monotributo')


--SCRIPT INSERT PROVINCIAS

INSERT INTO Provincias (Provincia)
VALUES('Capital Federal')

INSERT INTO Provincias (Provincia)
VALUES('Buenos Aires')

INSERT INTO Provincias (Provincia)
VALUES('Córdoba')

INSERT INTO Provincias (Provincia)
VALUES('Santa Fe')

INSERT INTO Provincias (Provincia)
VALUES('Mendoza')

INSERT INTO Provincias (Provincia)
VALUES('Tucumán')

INSERT INTO Provincias (Provincia)
VALUES('Entre Ríos')

INSERT INTO Provincias (Provincia)
VALUES('Salta')

INSERT INTO Provincias (Provincia)
VALUES('Misiones')

INSERT INTO Provincias (Provincia)
VALUES('Chaco')

INSERT INTO Provincias (Provincia)
VALUES('Corrientes')

INSERT INTO Provincias (Provincia)
VALUES('Santiago del Estero')

INSERT INTO Provincias (Provincia)
VALUES('Jujuy')

INSERT INTO Provincias (Provincia)
VALUES('San Juan')

INSERT INTO Provincias (Provincia)
VALUES('Río Negro')

INSERT INTO Provincias (Provincia)
VALUES('Formosa')

INSERT INTO Provincias (Provincia)
VALUES('Neuquén')

INSERT INTO Provincias (Provincia)
VALUES('Chubut')

INSERT INTO Provincias (Provincia)
VALUES('San Luis')

INSERT INTO Provincias (Provincia)
VALUES('Catamarca')

INSERT INTO Provincias (Provincia)
VALUES('La Rioja')

INSERT INTO Provincias (Provincia)
VALUES('La Pampa')

INSERT INTO Provincias (Provincia)
VALUES('Santa Cruz')

INSERT INTO Provincias (Provincia)
VALUES('Tierra del Fuego')

------------------------------------------------------------------
Instaladores
http://msdn.microsoft.com/en-us/library/49b92ztk.aspx

-------------------------------------------------------------------

Código Backup Database

string sBackup = "BACKUP DATABASE " + this.txtBase.Text + 
                 " TO DISK = N'" + this.txtBackup.Text +
                 "' WITH NOFORMAT, NOINIT, NAME =N'" + this.txtBase.Text +
                 "' -Full Database Backup',SKIP, STATS = 10";

SqlConnectionStringBuilder csb = new SqlConnectionStringBuilder();

csb.DataSource = this.txtServidor.Text;
csb.InitialCatalog = this.txtBase.Text;
csb.IntegratedSecurity = true;

using(SqlConnection con = new SqlConnection(csb.ConnectionString))
{
    try
    {
        con.Open();

        SqlCommand cmdBackUp = new SqlCommand(sBackup, con);

        cmdBackUp.ExecuteNonQuery();

        MessageBox.Show("Se ha creado un BackUp de La base de datos satisfactoriamente", 
            "Copia de seguridad de base de datos", 
            MessageBoxButtons.OK, MessageBoxIcon.Information);

        con.Close();
    }
    catch(Exception ex)
    {
        MessageBox.Show(ex.Message, 
            "Error al copiar la base de datos", 
            MessageBoxButtons.OK, MessageBoxIcon.Error);
    }
}
